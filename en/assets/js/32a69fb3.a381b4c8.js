"use strict";(self.webpackChunkmy_site=self.webpackChunkmy_site||[]).push([[9846],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>g});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),d=p(n),u=r,g=d["".concat(s,".").concat(u)]||d[u]||c[u]||o;return n?a.createElement(g,l(l({ref:t},m),{},{components:n})):a.createElement(g,l({ref:t},m))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[d]="string"==typeof e?e:r,l[1]=i;for(var p=2;p<o;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9992:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const o={},l="Day 27 : \u4f7f\u7528 TensorFlow Serving \u90e8\u7f72 REST API",i={unversionedId:"2021ITHome\u9435\u4eba\u8cfd\u300c\u5f9eAI\u843d\u5730\u8ac7MLOps\u300d/\u8ac7\u5be6\u8e10-\u90e8\u7f72 Deploying/Day 27",id:"2021ITHome\u9435\u4eba\u8cfd\u300c\u5f9eAI\u843d\u5730\u8ac7MLOps\u300d/\u8ac7\u5be6\u8e10-\u90e8\u7f72 Deploying/Day 27",title:"Day 27 : \u4f7f\u7528 TensorFlow Serving \u90e8\u7f72 REST API",description:"tags: MLOps",source:"@site/docs/2021ITHome\u9435\u4eba\u8cfd\u300c\u5f9eAI\u843d\u5730\u8ac7MLOps\u300d/\u8ac7\u5be6\u8e10-\u90e8\u7f72 Deploying/Day 27.md",sourceDirName:"2021ITHome\u9435\u4eba\u8cfd\u300c\u5f9eAI\u843d\u5730\u8ac7MLOps\u300d/\u8ac7\u5be6\u8e10-\u90e8\u7f72 Deploying",slug:"/2021ITHome\u9435\u4eba\u8cfd\u300c\u5f9eAI\u843d\u5730\u8ac7MLOps\u300d/\u8ac7\u5be6\u8e10-\u90e8\u7f72 Deploying/Day 27",permalink:"/my-site/en/docs/2021ITHome\u9435\u4eba\u8cfd\u300c\u5f9eAI\u843d\u5730\u8ac7MLOps\u300d/\u8ac7\u5be6\u8e10-\u90e8\u7f72 Deploying/Day 27",draft:!1,editUrl:"https://github.com/willismax/my-site/blob/main/docs/2021ITHome\u9435\u4eba\u8cfd\u300c\u5f9eAI\u843d\u5730\u8ac7MLOps\u300d/\u8ac7\u5be6\u8e10-\u90e8\u7f72 Deploying/Day 27.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u8ac7\u5be6\u8e10 - \u90e8\u7f72 Deploying",permalink:"/my-site/en/docs/category/\u8ac7\u5be6\u8e10---\u90e8\u7f72-deploying"},next:{title:"Day 28 : \u7528\u65bc\u751f\u7522\u7684\u6a5f\u68b0\u5b78\u7fd2 TensorFlow Extended (TFX) \u4ecb\u7d39",permalink:"/my-site/en/docs/2021ITHome\u9435\u4eba\u8cfd\u300c\u5f9eAI\u843d\u5730\u8ac7MLOps\u300d/\u8ac7\u5be6\u8e10-\u90e8\u7f72 Deploying/Day 28"}},s={},p=[{value:"tags: <code>MLOps</code>",id:"tags-mlops",level:6},{value:"\u4f7f\u7528 TensorFlow Serving \u90e8\u7f72 REST API \u5be6\u4f5c",id:"\u4f7f\u7528-tensorflow-serving-\u90e8\u7f72-rest-api-\u5be6\u4f5c",level:2},{value:"1. \u4e0b\u8f09\u8cc7\u6599\u53ca\u8a13\u7df4\u6a21\u578b",id:"1-\u4e0b\u8f09\u8cc7\u6599\u53ca\u8a13\u7df4\u6a21\u578b",level:3},{value:"2. \u5132\u5b58\u6a21\u578b",id:"2-\u5132\u5b58\u6a21\u578b",level:3},{value:"3. \u6aa2\u67e5\u6211\u5011\u7684Saved model",id:"3-\u6aa2\u67e5\u6211\u5011\u7684saved-model",level:3},{value:"4. \u5efa\u7acb TensorFlow Serving \u670d\u52d9",id:"4-\u5efa\u7acb-tensorflow-serving-\u670d\u52d9",level:3},{value:"5. \u555f\u52d5 TensorFlow Serving",id:"5-\u555f\u52d5-tensorflow-serving",level:3},{value:"6. \u5411 TensorFlow Serving \u63d0\u51fa\u8acb\u6c42",id:"6-\u5411-tensorflow-serving-\u63d0\u51fa\u8acb\u6c42",level:3},{value:"\u5c0f\u7d50",id:"\u5c0f\u7d50",level:2},{value:"\u53c3\u8003",id:"\u53c3\u8003",level:2}],m={toc:p},d="wrapper";function c(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"day-27--\u4f7f\u7528-tensorflow-serving-\u90e8\u7f72-rest-api"},"Day 27 : \u4f7f\u7528 TensorFlow Serving \u90e8\u7f72 REST API"),(0,r.kt)("h6",{id:"tags-mlops"},"tags: ",(0,r.kt)("inlineCode",{parentName:"h6"},"MLOps")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://ithelp.ithome.com.tw/users/20121130/ironman/4015"},(0,r.kt)("img",{parentName:"a",src:"https://d1dwq032kyr03c.cloudfront.net/images/ironman_sticker/13/ai-and-data.png?sticker",alt:null,title:"\u7b2c 13 \u5c46\u9435\u4eba\u8cfd\u934a\u6210"}),"\u7b2c 13 \u5c46\u9435\u4eba\u8cfd\u934a\u6210"),"\n",(0,r.kt)("a",{parentName:"p",href:"https://ithelp.ithome.com.tw/articles/10272257"},(0,r.kt)("img",{parentName:"a",src:"https://img.shields.io/badge/iThome%E9%90%B5%E4%BA%BA%E8%B3%BD2021-%E5%A8%81%E5%88%A9%E6%96%AF-blue",alt:null}))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728\u7db2\u8def\u60c5\u5883\u5e38\u4ee5 API \u8acb\u6c42\u670d\u52d9\uff0c\u7528\u65bc\u751f\u7522\u7684\u6a5f\u68b0\u5b78\u7fd2\u4ea6\u53ef\u7528 REST API \u5f62\u5f0f\u63d0\u4f9b\u670d\u52d9\u3002\u5728",(0,r.kt)("a",{parentName:"li",href:"https://ithelp.ithome.com.tw/articles/10267328"},"Day 20"),"\u3001",(0,r.kt)("a",{parentName:"li",href:"https://ithelp.ithome.com.tw/articles/10268124"},"Day 21"),"\u3001",(0,r.kt)("a",{parentName:"li",href:"https://ithelp.ithome.com.tw/articles/10268783"},"Day 22")," \u4ecb\u7d39\u90e8\u7f72\u5728\u7b97\u529b\u6709\u9650\u7684\u7d42\u7aef\u8a2d\u5099\u53ef\u63a1\u7528\u7684 TensorFlow Lite\uff0c\u672c\u7bc7\u5c07\u4f7f\u7528 \u900f\u904e TensorFlow Serving \u90e8\u7f72\u60a8\u7684\u6a21\u578b\u4f5c\u70ba\u7db2\u8def\u670d\u52d9\u53ef\u7528\u7684 REST API\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u7bc4\u4f8b\u53c3\u8003",(0,r.kt)("a",{parentName:"li",href:"https://www.tensorflow.org/tfx/tutorials/serving/rest_simple"},"\u5b98\u65b9\u7bc4\u4f8b"),"\u8abf\u6574\u800c\u6210\uff0c",(0,r.kt)("a",{parentName:"li",href:"https://colab.research.google.com/drive/1-9cCg9xhWQb7itAcLhko8UqpNOFnu-nx"},"Colab ",(0,r.kt)("img",{parentName:"a",src:"https://i.imgur.com/pQnQ4tG.png",alt:null}))," \u3002")),(0,r.kt)("h2",{id:"\u4f7f\u7528-tensorflow-serving-\u90e8\u7f72-rest-api-\u5be6\u4f5c"},"\u4f7f\u7528 TensorFlow Serving \u90e8\u7f72 REST API \u5be6\u4f5c"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5728\u6b64\u7bc4\u4f8b\u4e2d\uff0c\u60a8\u5c07\u90e8\u7f72\u4e00\u500b\u5177\u6709\u5206\u985e\u80fd\u529b\u7684 REST API \u670d\u52d9\uff0c\u6d41\u7a0b\u70ba",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5efa\u7acb\u8207\u8a13\u7df4\u6a21\u578b\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u5b89\u88dd\u8207\u555f\u52d5 TensorFlow Serving\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u4ee5 Requests \u5411 TensorFlow Serving \u63d0\u51fa\u8acb\u6c42\u3002")))),(0,r.kt)("h3",{id:"1-\u4e0b\u8f09\u8cc7\u6599\u53ca\u8a13\u7df4\u6a21\u578b"},"1","."," \u4e0b\u8f09\u8cc7\u6599\u53ca\u8a13\u7df4\u6a21\u578b"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7531\u65bc\u91cd\u9ede\u5728\u5982\u4f55\u555f\u52d5\u4e00\u500bTensorFlow Severing \u670d\u52d9\uff0c\u8cc7\u6599\u63a1\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"keras.datasets.cifar10")," \u9032\u884c\u793a\u7bc4\uff0c",(0,r.kt)("a",{parentName:"li",href:"https://keras.io/api/datasets/cifar10/"},"CIFAR10")," \u70ba\u5c0f\u578b\u7684\u5f71\u50cf\u5206\u985e\u8cc7\u6599\u96c6\uff0c\u5177\u6709 50,000 \u7b46\u8a13\u7df4\u8cc7\u6599\u96c6\u8207 10,000 \u7b46\u6e2c\u8a66\u8cc7\u6599\u96c6\uff0c\u7686\u70ba 32X32 \u50cf\u7d20\u7684\u5f69\u8272\u5716\u7247\u3002\u66f4\u591a\u8cc7\u8a0a\u53c3\u95b1",(0,r.kt)("a",{parentName:"li",href:"https://www.cs.toronto.edu/~kriz/cifar.html"},"\u5b98\u65b9\u4ecb\u7d39"),"\uff0c 10 \u7a2e\u5206\u985e\u8207\u63cf\u8ff0\u5982\u4e0b:",(0,r.kt)("br",{parentName:"li"}),(0,r.kt)("img",{parentName:"li",src:"https://i.imgur.com/PrFLRq6.png",alt:null})),(0,r.kt)("li",{parentName:"ul"},"\u5efa\u7acb\u7c21\u6613\u6a21\u578b\uff0c\u7a0b\u5f0f\u78bc\u53c3\u95b1 ",(0,r.kt)("a",{parentName:"li",href:"https://colab.research.google.com/drive/1-9cCg9xhWQb7itAcLhko8UqpNOFnu-nx"},"Colab")," \u3002",(0,r.kt)("br",{parentName:"li"}),(0,r.kt)("img",{parentName:"li",src:"https://i.imgur.com/SR4HB0a.png",alt:null}))),(0,r.kt)("h3",{id:"2-\u5132\u5b58\u6a21\u578b"},"2","."," \u5132\u5b58\u6a21\u578b"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5c07\u6a21\u578b\u4fdd\u5b58\u70ba",(0,r.kt)("a",{parentName:"p",href:"https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/saved_model"},"SavedModel"),"\u683c\u5f0f\uff0c\u4ee5\u4fbf\u5c07\u6a21\u578b\u52a0\u8f09\u5230 TensorFlow Serving \u4e2d\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://www.tensorflow.org/tfx/guide/serving"},"TensorFlow Serving"),"\u5141\u8a31\u6211\u5011\u5728\u767c\u51fa\u63a8\u7406\u8acb\u6c42\u6642\u9078\u64c7\u8981\u4f7f\u7528\u7684\u6a21\u578b\u7248\u672c\u6216\u300c\u53ef\u670d\u52d9\u300d\u7248\u672c\u3002\u6bcf\u500b\u7248\u672c\u5c07\u5c0e\u51fa\u5230\u7d66\u5b9a\u8def\u5f91\u4e0b\u7684\u4e0d\u540c\u5b50\u76ee\u9304\u3002\u70ba\u6b64\uff0c\u9700\u5728\u76ee\u9304\u5275\u5efa ",(0,r.kt)("inlineCode",{parentName:"p"},"protobuf")," \u6587\u4ef6\uff0c\u4e26\u5c07\u5305\u542b\u4e00\u500b\u7248\u672c\u865f\uff0c\u6b64\u7248\u672c\u865f\u78bc\u4e5f\u662f\u5f8c\u7e8c API \u6240\u4f7f\u7528\u7684\u53c3\u6578\u4e4b\u4e00\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u4ee5\u4e0b\u6703\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"/tmp/"),"\u5efa\u7acb\u7248\u6b21\u7248\u6b21",(0,r.kt)("inlineCode",{parentName:"p"},"version = 1"),"\u4e4b\u76f8\u95dc\u6a94\u6848\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# Fetch the Keras session and save the model\n# The signature definition is defined by the input and output tensors,\n# and stored with the default serving key\nimport tempfile\n\nMODEL_DIR = tempfile.gettempdir()\nversion = 1\nexport_path = os.path.join(MODEL_DIR, str(version))\nprint(f'export_path = {export_path}')\n\ntf.keras.models.save_model(\n    model,\n    export_path,\n    overwrite=True,\n    include_optimizer=True,\n    save_format=None,\n    signatures=None,\n    options=None\n)\n\nprint('Saved model:')\n!ls -l {export_path}\n\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/dz0pKwR.png",alt:null})))),(0,r.kt)("h3",{id:"3-\u6aa2\u67e5\u6211\u5011\u7684saved-model"},"3","."," \u6aa2\u67e5\u6211\u5011\u7684Saved model"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"saved_model_cli")," \u53ef\u4ee5\u6aa2\u67e5\u524d\u8ff0",(0,r.kt)("a",{parentName:"p",href:"https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/MetaGraphDef"},"SavedModel"),"\u4e2d\u76f8\u95dc\u8cc7\u8a0a\uff0c\u9019\u5c0d\u7406\u89e3\u6a21\u578b\u76f8\u7576\u6709\u7528\uff0c\u5305\u542b:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/MetaGraphDef"},"MetaGraphDefs"),"\uff08\u6a21\u578b\uff09"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.tensorflow.org/tfx/tutorials/signature_defs"},"SignatureDefs"),"\uff08\u60a8\u53ef\u4ee5\u8abf\u7528\u7684\u65b9\u6cd5\uff09"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"SavedModel CLI\u7684\u8a73\u7d30\u8aaa\u660e\u53ef\u53c3\u95b1",(0,r.kt)("a",{parentName:"p",href:"https://github.com/tensorflow/docs/blob/master/site/en/r1/guide/saved_model.md#cli-to-inspect-and-execute-savedmodel"},"TensorFlow \u6307\u5357"),"\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"!saved_model_cli show --dir {export_path} --all\n\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/ErI7EPu.png",alt:null}),(0,r.kt)("br",{parentName:"p"}),"\n","(\u4ee5\u4e0b\u7565)"))),(0,r.kt)("h3",{id:"4-\u5efa\u7acb-tensorflow-serving-\u670d\u52d9"},"4","."," \u5efa\u7acb TensorFlow Serving \u670d\u52d9"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u4f9d\u5b98\u65b9\u7bc4\u4f8b\u6b64\u70baColab\u74b0\u5883\u6240\u9700\u8a2d\u5b9a\u5167\u5bb9\uff0c\u5982\u4f7f\u7528\u672c\u6a5f\u7aef\u7684 Notebook \uff0c\u8acb\u6ce8\u610f\u76f8\u95dc\u63d0\u9192\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u4f7f\u7528 ",(0,r.kt)("a",{parentName:"p",href:"https://wiki.debian.org/Aptitude"},"Aptitude")," \u5b89\u88dd TensorFlow Serving\uff0c\u56e0\u70ba Colab \u5728 Debian \u74b0\u5883\u4e2d\u904b\u884c\uff0c\u6240\u4ee5\u53ef\u4ee5\u5b89\u88dd Debian \u76f8\u95dc\u5957\u4ef6\u3002\u5c07 ",(0,r.kt)("inlineCode",{parentName:"p"},"tensorflow-model-server")," \u4ee5 Root \u8eab\u5206\u6dfb\u52a0\u5230 Aptitude \u77e5\u9053\u7684\u5957\u4ef6\u5217\u8868\u4e2d\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u53e6\u5916\u6700\u7c21\u55ae\u7684\u65b9\u5f0f\u662f\u4ee5 Docker \u4f48\u7f72 TensorFlow Serving\uff0c\u60a8\u53ef\u81ea\u884c\u53c3\u8003",(0,r.kt)("a",{parentName:"p",href:"https://www.tensorflow.org/tfx/serving/docker"},"Docker \u7bc4\u4f8b"),"\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'\n!echo "deb http://storage.googleapis.com/tensorflow-serving-apt stable tensorflow-model-server tensorflow-model-server-universal" | {SUDO_IF_NEEDED} tee /etc/apt/sources.list.d/tensorflow-serving.list && \\\ncurl https://storage.googleapis.com/tensorflow-serving-apt/tensorflow-serving.release.pub.gpg | {SUDO_IF_NEEDED} apt-key add -\n!{SUDO_IF_NEEDED} apt update\n\n!{SUDO_IF_NEEDED} apt-get install tensorflow-model-server\n\n')))),(0,r.kt)("h3",{id:"5-\u555f\u52d5-tensorflow-serving"},"5","."," \u555f\u52d5 TensorFlow Serving"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u52a0\u8f09\u5f8c\uff0c\u6211\u5011\u53ef\u4ee5\u958b\u59cb\u4f7f\u7528 REST \u767c\u51fa\u63a8\u7406\u8acb\u6c42\uff0c\u76f8\u95dc\u53c3\u6578:"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"rest_api_port"),"\uff1a REST \u8acb\u6c42\u7684 Port\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"model_name"),"\uff1a\u60a8\u5c07\u5728 REST \u8acb\u6c42\u7684 URL \u4e2d\u4f7f\u7528\u5b83\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"model_base_path"),"\uff1a\u4fdd\u5b58\u6a21\u578b\u7684\u76ee\u9304\u7684\u8def\u5f91\u3002")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'%%bash --bg \nnohup tensorflow_model_server \\\n  --rest_api_port=8501 \\\n  --model_name=fashion_model \\\n  --model_base_path="${MODEL_DIR}" >server.log 2>&1\n\n\n')))),(0,r.kt)("h3",{id:"6-\u5411-tensorflow-serving-\u63d0\u51fa\u8acb\u6c42"},"6","."," \u5411 TensorFlow Serving \u63d0\u51fa\u8acb\u6c42"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u9810\u8a2d\u8acb\u6c42\u6700\u65b0\u7248\u672c\u7684 servable \u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"import requests\nheaders = {\"content-type\": \"application/json\"}\njson_response = requests.post(\n    'http://localhost:8501/v1/models/fashion_model:predict', \n    data=data, \n    headers=headers\n    )\n\npredictions = json.loads(json_response.text)['predictions']\n\nshow(0, 'The model thought this was a {} (class {}), and it was actually a {} (class {})'.format(\n  class_names[np.argmax(predictions[0])], np.argmax(predictions[0]), class_names[int(test_labels[0])], test_labels[0]))\n\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5411\u4f3a\u670d\u5668\u8acb\u6c42\u6307\u5b9a\u7248\u672c",(0,r.kt)("inlineCode",{parentName:"p"},"version = 1")," \u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# docs_infra: no_execute\nversion = 1\n\nheaders = {\"content-type\": \"application/json\"}\njson_response = requests.post(\n    f'http://localhost:8501/v1/models/fashion_model/versions/{version}:predict', \n    data=data, \n    headers=headers\n    )\n\npredictions = json.loads(json_response.text)['predictions']\n\nfor i in range(0,3):\n  show(i, 'The model thought this was a {} (class {}), and it was actually a {} (class {})'.format(\n    class_names[np.argmax(predictions[i])], np.argmax(predictions[i]), class_names[int(test_labels[i])], test_labels[i]))\n\n\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/71hvMBT.png",alt:null})))),(0,r.kt)("h2",{id:"\u5c0f\u7d50"},"\u5c0f\u7d50"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u7531\u65bc\u63d0\u4f9b\u7db2\u8def\u670d\u52d9\u7684\u5de5\u7a0b\u5e2b\u76f8\u7576\u719f\u6089 REST API \u7684\u6e9d\u901a\u65b9\u5f0f\uff0c\u4ee5\u6307\u5b9a URI \u5373\u53ef\u53d6\u5f97\u6240\u9700\u8cc7\u8a0a\u76f8\u7576\u4fbf\u6377\uff0c\u60a8\u4e5f\u6703\u767c\u73fe TensorFlow Serving \u7c21\u5316\u8af8\u591a\u90e8\u7f72 API \u7684\u8a2d\u5b9a\u7d30\u7bc0\u3002"),(0,r.kt)("li",{parentName:"ul"},"\u622a\u81f3\u6b64\u7bc7\u6587\u7ae0\u5c07\u5be6\u8e10 MLOps \u5728\u7bc4\u7587\u3001\u8cc7\u6599\u3001\u6a21\u578b\u8207\u90e8\u7f72\u7684\u76f8\u95dc\u6982\u5ff5\u8207\u505a\u6cd5\u4ecb\u7d39\u5f8c\uff0c\u63a5\u9023 2 \u7bc7\u5c07\u63a5\u7d39\u7528\u65bc\u751f\u7522\u7684\u6a5f\u68b0\u5b78\u7fd2\u6846\u67b6 TensorFlow Extended (TFX) \uff0c\u8b1d\u8b1d\u60a8\u4e00\u8def\u5805\u6301\u81f3\u4eca\uff0c\u6211\u5011\u4e0b\u7bc7\u898b\u3002",(0,r.kt)("br",{parentName:"li"}),(0,r.kt)("img",{parentName:"li",src:"https://ithelp.ithome.com.tw/images/emoticon/emoticon41.gif",alt:"/images/emoticon/emoticon41.gif"}))),(0,r.kt)("h2",{id:"\u53c3\u8003"},"\u53c3\u8003"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.tensorflow.org/tfx/tutorials/serving/rest_simple"},"TensorFlow Serving \u7bc4\u4f8b\u8aaa\u660e"))))}c.isMDXComponent=!0}}]);