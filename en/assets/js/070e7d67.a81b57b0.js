"use strict";(self.webpackChunkmy_site=self.webpackChunkmy_site||[]).push([[9828],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>u});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),m=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=m(e.components);return a.createElement(o.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),d=m(n),k=r,u=d["".concat(o,".").concat(k)]||d[k]||c[k]||i;return n?a.createElement(u,l(l({ref:t},s),{},{components:n})):a.createElement(u,l({ref:t},s))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=k;var p={};for(var o in t)hasOwnProperty.call(t,o)&&(p[o]=t[o]);p.originalType=e,p[d]="string"==typeof e?e:r,l[1]=p;for(var m=2;m<i;m++)l[m]=n[m];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},6568:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>c,frontMatter:()=>i,metadata:()=>p,toc:()=>m});var a=n(7462),r=(n(7294),n(3905));const i={},l=void 0,p={unversionedId:"2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c/Day28_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u4f48\u7f72\u7bc7",id:"2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c/Day28_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u4f48\u7f72\u7bc7",title:"Day28_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u4f48\u7f72\u7bc7",description:"\u5728 LINE \u804a\u5929\u6a5f\u5668\u4eba\u67e5\u8a62 K \u7dda\u5716\u529f\u80fd\u5be6\u4f5c",source:"@site/docs/2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/10.\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c/Day28_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u4f48\u7f72\u7bc7.md",sourceDirName:"2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/10.\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c",slug:"/2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c/Day28_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u4f48\u7f72\u7bc7",permalink:"/my-site/en/docs/2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c/Day28_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u4f48\u7f72\u7bc7",draft:!1,editUrl:"https://github.com/willismax/my-site/blob/main/docs/2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/10.\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c/Day28_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u4f48\u7f72\u7bc7.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Day27_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u529f\u80fd\u5be6\u4f5c",permalink:"/my-site/en/docs/2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c/Day27_\u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-\u529f\u80fd\u5be6\u4f5c"},next:{title:"Day29_\u63db\u500bLINE\u56de\u61c9\u7684\u5176\u4ed6\u53e3\u5473-FlexMessage",permalink:"/my-site/en/docs/2020ITHome\u9435\u4eba\u8cfd\u300c\u7528 LINE \u4e32\u8d77\u591a\u5a92\u9ad4\u7cfb\u7d71\u300d\u7cfb\u5217\u6587/\u8cc7\u6599\u8996\u89ba\u5316\u5be6\u4f5c/Day29_\u63db\u500bLINE\u56de\u61c9\u7684\u5176\u4ed6\u53e3\u5473-FlexMessage"}},o={},m=[{value:"\u5728 LINE \u804a\u5929\u6a5f\u5668\u4eba\u67e5\u8a62 K \u7dda\u5716\u529f\u80fd\u5be6\u4f5c",id:"\u5728-line-\u804a\u5929\u6a5f\u5668\u4eba\u67e5\u8a62-k-\u7dda\u5716\u529f\u80fd\u5be6\u4f5c",level:2},{value:"\u5be6\u4f5c",id:"\u5be6\u4f5c",level:3},{value:"\u62c6\u89e3\u8aaa\u660e",id:"\u62c6\u89e3\u8aaa\u660e",level:3},{value:"\u95dc\u65bc\u5751\uff0c\u8aaa\u597d\u7684\u5751\u54a7?",id:"\u95dc\u65bc\u5751\u8aaa\u597d\u7684\u5751\u54a7",level:3},{value:"\u5c0f\u7d50",id:"\u5c0f\u7d50",level:3}],s={toc:m},d="wrapper";function c(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u5728-line-\u804a\u5929\u6a5f\u5668\u4eba\u67e5\u8a62-k-\u7dda\u5716\u529f\u80fd\u5be6\u4f5c"},"\u5728 LINE \u804a\u5929\u6a5f\u5668\u4eba\u67e5\u8a62 K \u7dda\u5716\u529f\u80fd\u5be6\u4f5c"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/bm5wyXA.png",alt:null})),(0,r.kt)("p",null,"\u63a5\u7e8c\u64f7\u53d6\u80a1\u50f9\u8cc7\u8a0a\u7e6a\u88fdK\u7dda\u5716\u7684\u5167\u5bb9\uff0c\u63a5\u8457\u6211\u5011\u8b93 LINE \u80fd\u5920\u900f\u904e\u95dc\u9375\u5b57\u8f38\u5165\u67e5\u8a62\u689d\u4ef6\u3002\u5225\u5c0f\u770b\u9019\u4e00\u6bb5\uff0c\u5751\u5f88\u591a\uff0c\u6703\u9010\u6b65\u8ddf\u60a8\u8aaa\u660e\u5982\u4f55\u514b\u670d(\u586b\u5751)\u3002"),(0,r.kt)("h3",{id:"\u5be6\u4f5c"},"\u5be6\u4f5c"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5148\u63d0\u4f9b\u672c\u7bc7\u7bc4\u4f8b\u5b8c\u6210\u7684\u7a0b\u5f0f\u78bc\uff0c\u9996\u5148 ",(0,r.kt)("inlineCode",{parentName:"p"},"app.py")," \u6a94\u6848\u5305\u542b\u672c\u6b21K\u7dda\u5716\u529f\u80fd\u3001\u7cfb\u5217\u6587\u5148\u524d\u958b\u767c\u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"@\u7ffb\u82f1")," \u3001 ",(0,r.kt)("inlineCode",{parentName:"p"},"@\u7ffb\u4e2d")," \u3001 ",(0,r.kt)("inlineCode",{parentName:"p"},"@\u7ffb\u65e5")," \u529f\u80fd:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from flask import Flask, request, abort\n\nfrom linebot import (\n    LineBotApi, WebhookHandler\n)\nfrom linebot.exceptions import (\n    InvalidSignatureError\n)\nfrom linebot.models import (\n    MessageEvent, TextMessage, TextSendMessage, ImageSendMessage\n)\n\nfrom googletrans import Translator\n\napp = Flask(__name__)\n\nfrom config import * \n\nline_bot_api = LineBotApi(channel_access_token)\nhandler = WebhookHandler(channel_secret)\n")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'@app.route("/callback", methods=[\'POST\'])\ndef callback():\n    # get X-Line-Signature header value\n    signature = request.headers[\'X-Line-Signature\']\n\n    # get request body as text\n    body = request.get_data(as_text=True)\n    app.logger.info("Request body: " + body)\n\n    # handle webhook body\n    try:\n        handler.handle(body, signature)\n    except InvalidSignatureError:\n        print("Invalid signature. Please check your channel access token/channel secret.")\n        abort(400)\n\n    return \'OK\'\n\ndef translate_text(text,dest=\'en\'):\n    """\u4ee5google\u7ffb\u8b6f\u5c07text\u7ffb\u8b6f\u70ba\u76ee\u6a19\u8a9e\u8a00\n\n    :param text: \u8981\u7ffb\u8b6f\u7684\u5b57\u4e32\uff0c\u63a5\u53d7UTF-8\u7de8\u78bc\u3002\n    :param dest: \u8981\u7ffb\u8b6f\u7684\u76ee\u6a19\u8a9e\u8a00\uff0c\u53c3\u95b1googletrans.LANGCODES\u8a9e\u8a00\u5217\u8868\u3002\n    """\n    translator = Translator()\n    result = translator.translate(text, dest).text\n    return result\n\n# import mplfinance as mpf\nimport yfinance as yf\nimport pandas_datareader.data as web\nimport pyimgur\n\nIMGUR_CLIENT_ID = imgur_client_id\n\ndef plot_stcok_k_chart(IMGUR_CLIENT_ID,stock="0050" , date_from=\'2020-01-01\' ):\n    """\n    \u9032\u884c\u500b\u80a1K\u7dda\u7e6a\u88fd\uff0c\u56de\u50b3\u81f3\u65bc\u96f2\u7aef\u5716\u5e8a\u7684\u9023\u7d50\u3002\u5c07\u986f\u793a\u5305\u542b5MA\u300120MA\u53ca\u91cf\u50f9\u95dc\u4fc2\uff0c\u8d77\u59cb\u9810\u8a2d\u81ea2020-01-01\u8d77\u8fc4\u6628\u65e5\u6536\u76e4\u50f9\u3002\n    :stock :\u500b\u80a1\u4ee3\u78bc(\u5b57\u4e32)\uff0c\u9810\u8a2d0050\u3002\n    :date_from :\u8d77\u59cb\u65e5(\u5b57\u4e32)\uff0c\u683c\u5f0f\u70baYYYY-MM-DD\uff0c\u9810\u8a2d\u81ea2020-01-01\u8d77\u3002\n    """\n    stock = str(stock)+".tw"\n    # df = web.DataReader(stock, \'yahoo\', date_from) \n    df = yf.download(stock, date_from) \n    mpf.plot(df,type=\'candle\',mav=(5,20),volume=True, ylabel=stock.upper()+\' Price\' ,savefig=\'testsave.png\')\n    PATH = "testsave.png"\n    im = pyimgur.Imgur(IMGUR_CLIENT_ID)\n    uploaded_image = im.upload_image(PATH, title=stock+" candlestick chart")\n    return uploaded_image.link\n\n@handler.add(MessageEvent, message=TextMessage)\ndef handle_message(event):\n    if event.source.user_id ==\'Udeadbeefdeadbeefdeadbeefdeadbeef\':\n        return \'OK\'\n    if event.message.text[:3] == "@\u7ffb\u82f1":\n        content = translate_text(event.message.text[3:], "en")\n        message = TextSendMessage(text=content)\n        line_bot_api.reply_message(event.reply_token, message)\n    if event.message.text[:3] == "@\u7ffb\u65e5":\n        content = translate_text(event.message.text[3:] , "ja")\n        message = TextSendMessage(text=content)\n        line_bot_api.reply_message(event.reply_token, message)\n    if event.message.text[:3] == "@\u7ffb\u4e2d":\n        content = translate_text(event.message.text[3:] , "zh-tw")\n        message = TextSendMessage(text=content)\n        line_bot_api.reply_message(event.reply_token, message)\n    if event.message.text[:2].upper() == "@K":\n        input_word = event.message.text.replace(" ","") #\u5408\u4f75\u5b57\u4e32\u53d6\u6d88\u7a7a\u767d\n        stock_name = input_word[2:6] #2330\n        start_date = input_word[6:] #2020-01-01\n        content = plot_stcok_k_chart(IMGUR_CLIENT_ID,stock_name,start_date)\n        message = ImageSendMessage(original_content_url=content,preview_image_url=content)\n        line_bot_api.reply_message(event.reply_token, message)\n\n    else: line_bot_api.reply_message(event.reply_token,\n                                     TextSendMessage(text=event.message.text))\n\n\nif __name__ == "__main__":\n    app.run()\n```\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"requirements.txt")," \u4e5f\u6709\u65b0\u589e ",(0,r.kt)("inlineCode",{parentName:"p"},"yfinace"),"\u3001",(0,r.kt)("inlineCode",{parentName:"p"},"mplfinance")," \u3001 ",(0,r.kt)("inlineCode",{parentName:"p"},"pandas_datareader")," \u3001 ",(0,r.kt)("inlineCode",{parentName:"p"},"pyimgur")," \u7b493\u500b\u5916\u90e8\u6a21\u7d44\uff0c\u60a8\u53ef\u4ee5\u6ce8\u610f\u5230 ",(0,r.kt)("inlineCode",{parentName:"p"},"pandas_datareader")," \u7684\u7248\u672c\u5c45\u7136\u662f ",(0,r.kt)("inlineCode",{parentName:"p"},"0.9.0rc1")," \uff0c\u5982\u975e\u6307\u5b9a\u4e0d\u6703\u662f\u6b64\u7248\u672c\uff0c\u6b64\u6642\u60a8\u6703\u9047\u5230\u4e00\u500b\u96e3\u89e3\u7684\u5751!(2022/4/15\u66f4\u65b0:",(0,r.kt)("inlineCode",{parentName:"p"},"pandas_datareader"),"\u5df2\u77e5\u6709\u672a\u4fee\u5fa9\u932f\u8aa4\uff0c\u4e4b\u5f8c\u7684\u8b80\u8005\u5efa\u8b70\u63a1\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"yfinace"),"\u6a21\u7d44)"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"Flask==1.1.2\nline-bot-sdk==1.16.0\ngunicorn==20.0.4\napscheduler==3.6.3\ngoogletrans==3.0.0\n# mplfinance\nyfinace\npandas_datareader==0.9.0rc1\npyimgur\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u4fee\u6b63 ",(0,r.kt)("inlineCode",{parentName:"p"},"config.py")," \uff0c\u9019\u662f\u6211\u5011\u7528\u4f86\u5b58\u5e33\u5bc6 Token \uff0c\u4f5c\u70ba\u5916\u90e8\u6a21\u7d44\u5f15\u7528\u7684\uff0c\u5982\u679c\u60a8\u6709\u7167\u8457\u7cfb\u5217\u6587 ",(0,r.kt)("a",{parentName:"p",href:"https://ithelp.ithome.com.tw/articles/10235290"},"Day 16 \u7684 Heroku \u8a2d\u5b9a")," \uff0c\u5728\u8a72\u6a94\u6848\u5f8c\u65b9\u589e\u52a0 Imgur \u7684 ",(0,r.kt)("inlineCode",{parentName:"p"},"Client_ID"),":"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#line-bot\nchannel_access_token = 'YOUR_CHANNEL_ACCESS_TOKEN' \nchannel_secret = 'YOUR_CHANNEL_SECRET'\n# Imgur\nimgur_client_id = 'YPUR_IMGUR_CLIENT_ID'\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6700\u5f8c\u60a8\u7684\u5c08\u6848\u8cc7\u6599\u593e\u7d50\u69cb\u5982\u4e0b\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"clock.py")," \u662f\u6e90\u81ea\u7cfb\u5217\u6587 ",(0,r.kt)("a",{parentName:"p",href:"https://ithelp.ithome.com.tw/articles/10235590"},"Day 17")," \u7684\u8a2d\u5b9a\uff0c\u5982\u60a8\u5230\u6b64\u6642\u7121\u6cd5\u9806\u5229\u57f7\u884c\u529f\u80fd\uff0c\u5efa\u8b70\u60a8\u56de\u982d\u700f\u89bd\u7cfb\u5217\u6587 ",(0,r.kt)("a",{parentName:"p",href:"https://ithelp.ithome.com.tw/articles/10235146"},"Day 15")," \u4e4b\u5f8c\u7684\u4e00\u7cfb\u5217 Heroku \u5b89\u88dd\u89e3\u8aaa\u3002"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/PNeMbuu.png",alt:null}),"\n"))),(0,r.kt)("h3",{id:"\u62c6\u89e3\u8aaa\u660e"},"\u62c6\u89e3\u8aaa\u660e"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u9996\u5148\u6211\u5011\u5c07 ",(0,r.kt)("a",{parentName:"li",href:"https://ithelp.ithome.com.tw/articles/10241574"},"Day 27 : \u80a1\u5e02K\u7ddaLINE\u804a\u5929\u6a5f\u5668\u4eba\u5be6\u4f5c-1"),"\u5df2\u7d93\u6253\u5305\u88dd\u597d\u7684\u51fd\u6578 ",(0,r.kt)("inlineCode",{parentName:"li"},"plot_stcok_k_chart()")," \uff0c\u52a0\u5165\u539f\u4f86\u7684\u7a0b\u5f0f\uff0c\u4e26\u4e14\u5f15\u51653\u500b\u6a21\u7d44\u8b93 ",(0,r.kt)("inlineCode",{parentName:"li"},"app.py")," \u8a8d\u8b58\u4ee5\u5229\u64cd\u4f5c:",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# import mplfinance as mpf\nimport yfinance as yf\nimport pandas_datareader.data as web\nimport pyimgur\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"plot_stcok_k_chart()"),"\u51fd\u6578\u529f\u80fd\u5efa\u7acb\u4e4b\u5f8c\uff0c\u63a5\u8457\u7e7c\u7e8c\u7528 ",(0,r.kt)("inlineCode",{parentName:"li"},"handle_message()")," \u51fd\u6578\u8655\u7406\u4f7f\u7528\u8005\u900f\u904eLINE\u50b3\u4f86\u7684\u8a0a\u606f\uff0c\u9019\u6b21\u6211\u5011\u4e5f\u7528\u689d\u4ef6\u5f0f ",(0,r.kt)("inlineCode",{parentName:"li"},"if")," \u4f86\u5224\u65b7\uff0c\u7576\u4f7f\u7528\u8005\u7684\u6587\u5b57\u8a0a\u606f\u958b\u982d\u70ba ",(0,r.kt)("inlineCode",{parentName:"li"},"@k")," \u6216 ",(0,r.kt)("inlineCode",{parentName:"li"},"@K")," \u6642\uff0c\u5207\u5272\u76f8\u95dc\u5b57\u4e32\u4f5c\u70ba\u53c3\u6578\u50b3\u5165 ",(0,r.kt)("inlineCode",{parentName:"li"},"plot_stcok_k_chart()")," \u51fd\u6578\u88e1\uff0c\u7bc0\u9304\u8a72\u529f\u80fd\u5982\u4e0b:",(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'@handler.add(MessageEvent, message=TextMessage)\ndef handle_message(event):\n    if event.message.text[:2].upper() == "@K":\n        input_word = event.message.text.replace(" ","") #\u5408\u4f75\u5b57\u4e32\u53d6\u6d88\u7a7a\u767d\n        stock_name = input_word[2:6] #2330\n        start_date = input_word[6:] #2020-01-01\n        content = plot_stcok_k_chart(IMGUR_CLIENT_ID,stock_name,start_date)\n        message = ImageSendMessage(original_content_url=content,preview_image_url=content)\n        line_bot_api.reply_message(event.reply_token, message)\n')),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'event.message.text[:2].upper() == "@K"')," \uff0c\u6307\u7684\u662f\u6536\u5230 ",(0,r.kt)("inlineCode",{parentName:"li"},"@k")," \u6216 ",(0,r.kt)("inlineCode",{parentName:"li"},"@K")," \u689d\u4ef6\u6210\u7acb\u57f7\u884c\u4ee5\u4e0b\u7e2e\u6392\u5167\u5bb9\uff0c\u9019\u88e1\u900f\u904e ",(0,r.kt)("inlineCode",{parentName:"li"},"str.upper()")," \u7d71\u4e00\u5927\u5c0f\u5beb\u7686\u8f49\u70ba\u5927\u5beb\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'input_word = event.message.text.replace(" ","")')," \u7528\u5230\u4e86 ",(0,r.kt)("inlineCode",{parentName:"li"},'str.replace(" ","")')," \u51fd\u6578\uff0c\u610f\u601d\u662f\u51e1\u662f\u6b64\u5b57\u4e32\u6709\u7a7a\u767d\u7684\u5730\u65b9\uff0c\u90fd\u88ab\u53d6\u4ee3\u70ba\u6c92\u6709\u7a7a\u767d\uff0c\u65b9\u4fbf\u4f7f\u7528\u8005\u8f38\u5165\u6642\u53ef\u4ee5\u81ea\u7531\u7559\u7a7a\u683c\uff0c\u53cd\u6b63\u6211\u90fd\u6703\u53d6\u4ee3\u6389\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"stock_name")," \u3001 ",(0,r.kt)("inlineCode",{parentName:"li"},"start_date")," \u6b642\u8b8a\u6578\u4f9d\u64da\u4f7f\u7528\u8005\u8f38\u5165\u5207\u7247\u8a08\u7b97\uff0c\u4e14\u5df2\u7d93\u90fd\u6c92\u6709\u7a7a\u683c\uff0c\u5982\u679c\u4f7f\u7528\u8005\u4f9d\u529f\u80fd\u8f38\u5165\u53ef\u4ee5\u9806\u5229\u5207\u7247\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"content")," \u8b8a\u6578\u63a5\u6536 ",(0,r.kt)("inlineCode",{parentName:"li"},"plot_stcok_k_chart()")," \u57f7\u884c\u7d50\u679c\uff0c\u53c3\u65781\u6240\u8981\u7684",(0,r.kt)("inlineCode",{parentName:"li"},"IMGUR_CLIENT_ID"),"\u5df2\u7d93\u5728\u7a0b\u5f0f\u78bc\u5ba3\u544a\uff0c\u5167\u5bb9\u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"config.py"),"\u4f5c\u70ba\u5916\u90e8\u6a21\u7d44\u5f15\u5165\uff1b\u5f8c\u7e8c\u70ba\u5207\u7247\u5167\u5bb9\uff0c\u5206\u5225\u5f15\u5165 ",(0,r.kt)("inlineCode",{parentName:"li"},"\u53f0\u80a1\u540d\u7a31")," \u3001 ",(0,r.kt)("inlineCode",{parentName:"li"},"\u8cc7\u6599\u8d77\u59cb\u65e5")," \u3002"),(0,r.kt)("li",{parentName:"ul"},"\u900f\u904e LINE \u56de\u50b3\u4f7f\u7528\u8005\u5716\u7247\u8a0a\u606f\uff0c\u9700\u8981\u7528\u5230",(0,r.kt)("inlineCode",{parentName:"li"},"linebot.models.ImageSendMessage()")," \u6a21\u7d44\uff0c\u5df2\u7d93\u4ee5 ",(0,r.kt)("inlineCode",{parentName:"li"},"from linebot.models import ImageSendMessage")," \u5728 ",(0,r.kt)("inlineCode",{parentName:"li"},"app.py")," \u958b\u982d\u6642\u5f15\u5165\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ImageSendMessage()")," \u51fd\u6578\u9700\u8981\u5169\u500b\u53c3\u6578\uff0c",(0,r.kt)("inlineCode",{parentName:"li"},"original_content_url")," \u53ca ",(0,r.kt)("inlineCode",{parentName:"li"},"preview_image_url")," \u5206\u5225\u4ee3\u8868\u539f\u5716\u53ca\u9810\u89bd\u7e2e\u5716\uff0c\u63a5\u53d7\u4ee5",(0,r.kt)("inlineCode",{parentName:"li"},"https://")," \u958b\u982d\u7684\u5716\u7247\u9023\u7d50\uff0c\u9019\u4e5f\u662f\u70ba\u4f55\u8981\u5728",(0,r.kt)("a",{parentName:"li",href:"https://ithelp.ithome.com.tw/articles/10241006"},"Day 26")," \u89e3\u8aaa\u5982\u4f55\u4e0a\u50b3\u5716\u7247\u81f3\u5716\u5e8a\u7684\u539f\u56e0\uff0c\u56e0\u70ba\u9700\u8981 ",(0,r.kt)("inlineCode",{parentName:"li"},"HTTPS"),"\u800c\u4e14\u6211\u662f\u500b\u514d\u8cbb\u7684\u8e6d\u98ef\u4ed4\u3002\u5982\u679c\u5927\u5c0f\u5728\u9650\u5236\u7bc4\u570d\u5167\uff0c\u5169\u500b\u5716\u7247\u9023\u7d50\u76f8\u7b49\u5373\u53ef"),(0,r.kt)("li",{parentName:"ul"},"\u6700\u5f8c\u900f\u904e ",(0,r.kt)("inlineCode",{parentName:"li"},"line_bot_api.reply_message(event.reply_token, message)")," \u5c07\u5e36\u6709 ",(0,r.kt)("inlineCode",{parentName:"li"},"event.reply_token")," \u7684\u8a0a\u606f ",(0,r.kt)("inlineCode",{parentName:"li"},"message")," \u6309\u7167LineBot API \u8981\u6c42\u7d44\u88dd\uff0c\u5c31\u9806\u5229\u5b8c\u6210\u5566!")))),(0,r.kt)("h3",{id:"\u95dc\u65bc\u5751\u8aaa\u597d\u7684\u5751\u54a7"},"\u95dc\u65bc\u5751\uff0c\u8aaa\u597d\u7684\u5751\u54a7?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u9996\u5148\u662f\u5f15\u5165\u7b2c\u4e09\u65b9\u6a21\u7d44\uff0c\u7279\u5225\u662f\u50cf ",(0,r.kt)("inlineCode",{parentName:"p"},"mplfinance")," \u3001 ",(0,r.kt)("inlineCode",{parentName:"p"},"pandas_datareader")," \u9019\u7a2e\u6bd4\u8f03\u9ad8\u968e(\u8cbc\u8fd1\u4eba\u6027\u4f7f\u7528)\u7684\u6a21\u7d44\uff0c\u80cc\u5f8c\u76f8\u4f9d\u5957\u4ef6\u5f88\u591a\uff0c\u4e14\u5728 ",(0,r.kt)("inlineCode",{parentName:"p"},"Colab")," \u904b\u884c\u6b63\u5e38\uff0c\u7d50\u679c\u4f48\u7f72\u5728 Heroku \u6642\u5c31\u51fa\u932f\uff0c\u9084\u597d\u76ee\u524d ",(0,r.kt)("inlineCode",{parentName:"p"},"pandas_datareader")," \u7684 0.9.0rc \u7248\u7d93\u6e2c\u8a66\u53ef\u7528\uff0c\u7279\u5225\u6307\u5b9a\u5f15\u5165\u7248\u672c\u3002(2022/4/15\u66f4\u65b0:",(0,r.kt)("inlineCode",{parentName:"p"},"pandas_datareader"),"\u5df2\u77e5\u6709\u672a\u4fee\u5fa9\u932f\u8aa4\uff0c\u4e4b\u5f8c\u7684\u8b80\u8005\u5efa\u8b70\u63a1\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"yfinace"),"\u6a21\u7d44)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728 Colab \u5be6\u4f5c\u7bc4\u4f8b\u6700\u7d42\u5b8c\u6210\u7684\u7b2c2\u500b\u6a21\u7d44\uff0c\u4f7f\u7528\u8005\u53ea\u8981\u8f38\u5165",(0,r.kt)("inlineCode",{parentName:"p"},"@k <\u53f0\u80a1\u4ee3\u78bc> <\u591a\u5c11\u5929>")," \u5373\u53ef\u986f\u793aK\u7dda\u5716\uff0c\u4f46\u5728 Heroku \u4f48\u7f72\u6642\u4e00\u76f4\u5831\u932f\uff0c\u90fd\u8ddf\u8cc7\u6599\u578b\u5225\u6709\u95dc\uff0c\u9664\u932f\u5f88\u4e45\u5f8c\u6700\u5f8c\u4f48\u7f72\u63a1\u7b2c\u4e00\u500b\u7248\u672c\uff0c\u8b93\u4f7f\u7528\u8005\u8f38\u5165 ",(0,r.kt)("inlineCode",{parentName:"p"},"@k <\u53f0\u80a1\u4ee3\u78bc> <\u8d77\u59cb\u65e5>")," \u6216 ",(0,r.kt)("inlineCode",{parentName:"p"},"@k <\u53f0\u80a1\u4ee3\u78bc>")," \u5373\u53ef\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u53e6\u5916\u662f ",(0,r.kt)("inlineCode",{parentName:"p"},"pandas_datareader")," \u7684\u8cc7\u8a0a\u4f86\u6e90 ",(0,r.kt)("inlineCode",{parentName:"p"},"Yahoo! France")," \uff0c\u4e0d\u898b\u5f97\u6709\u5168\u90e8\u53f0\u80a1\u8cc7\u8a0a\uff0c\u76ee\u524d\u6c92\u505a\u9632\u5446\u6a5f\u5236\uff0c\u5982\u679c ",(0,r.kt)("inlineCode",{parentName:"p"},"Yahoo! France")," \u7121\u6b64\u80a1\u7968\u8cc7\u8a0a\uff0c\u5247\u6b64\u529f\u80fd\u60a8\u7684 LINE \u6703\u5df2\u8b80\u4e0d\u56de\u3002(2022/4/15\u66f4\u65b0:",(0,r.kt)("inlineCode",{parentName:"p"},"pandas_datareader"),"\u5df2\u77e5\u6709\u672a\u4fee\u5fa9\u932f\u8aa4\uff0c\u4e4b\u5f8c\u7684\u8b80\u8005\u5efa\u8b70\u63a1\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"yfinace"),"\u6a21\u7d44)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u9664\u932f\u7684\u65b9\u5f0f\u4ecd\u7136\u96e2\u4e0d\u958b log \u6a94\u67e5\u8a62\u932f\u8aa4\uff0c\u6703\u63d0\u793a\u932f\u8aa4\u7684\u6a94\u540d\u3001\u884c\u6578\u4e26\u6301\u7e8c\u5411\u4e0a\u8ffd\u6eaf\u66f4\u5e95\u5c64\u7684\u7a0b\u5f0f\uff0c\u767c\u751f\u554f\u984c\u6642\u81f3 Heroku \u7db2\u7ad9\u67e5\u770b\uff0c\u6216\u5728\u7d42\u7aef\u6a5f\u8f38\u5165 ",(0,r.kt)("inlineCode",{parentName:"p"},"$ heroku logs")," \u67e5\u95b1\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"$ heroku logs\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("img",{parentName:"p",src:"https://i.imgur.com/ckczmwk.png",alt:null})," "))),(0,r.kt)("h3",{id:"\u5c0f\u7d50"},"\u5c0f\u7d50"),(0,r.kt)("p",null,"\u60a8\u5df2\u900f\u904e Python \u5b8c\u6210\u8cc7\u6599\u64f7\u53d6\u3001 Flask \u4f3a\u670d\u5668\u67b6\u8a2d\u3001 Line Bot API \u529f\u80fd\u4e32\u63a5 \u3001 Pandas \u8cc7\u6599\u8655\u7406\u3001 matplotlib \u8cc7\u6599\u8996\u89ba\u5316\uff0c \u4e26\u4e14\u8f38\u51fa\u81f3\u96f2\u7aef\u5716\u5e8a\u986f\u793a\u7d66\u4f7f\u7528\u8005\uff0c\u6574\u500b\u591a\u5a92\u9ad4\u7cfb\u7d71 IPO \u6d41\u7a0b\u5df2\u7d93\u8d70\u5b8c\u4e00\u904d\u53c8\u4e00\u904d\uff0c\u4e0b\u7bc7\u88dc\u5b8c\u4e00\u4e9b\u529f\u80fd\u5f8c\u6e96\u5099\u6536\u5c3e\u56c9\uff0c\u6211\u5011\u4e0b\u7bc7\u898b\u3002"))}c.isMDXComponent=!0}}]);